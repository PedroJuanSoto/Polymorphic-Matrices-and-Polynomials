module Main where
import Random_matrix_code

x = Nums (Coef [0,1]) 4

aa = x^11 + x^10 + x^9 + (x^4 + x^2)* x^2 + (x^3 + x^2 + 1)* (x^4 + 1) + 1
ab = x^12 + x^7 + (x^12 + x^2)* x^3 + (x^4 + 1)* x^2 + (x^3 + x^2 + 1)* (x^4 + x^2)
ac = x^7 + (x^4 + 1)* x^4 + (x^3 + 1)* x^3 + (x^4 + x^2)* (x^4 + x^3 + x^2 + 1)
ad = (x^4 + 1)* x^3 + x^3 + x^2 + (x^3 + x)* (x^4 + x^2) + (x^4 + 1)* (x^7 + x^3 + 1) + 1

ba = (x^3 + x^2 + 1)* x^7 + (x^9 + x^2)* x^6 + (x^3 + x^2 + 1)* x^2 + (x^4 + 1)* (x^11 + x^10 + 1)
bb = x^9 + (x^3 + x^2 + 1)^2 + (x^9 + x^2)* (x^12 + x^2) + (x^4 + 1)* (x^12 + x^7)
bc = x^11 + (x^4 + 1)* x^7 + (x^3 + x^2 + 1)* (x^4 + x^3 + x^2 + 1) + (x^3 + 1)* (x^9 + x^2)
bd = (x^7 + x^3 + 1)* x^7 + (x^3 + x)* (x^3 + x^2 + 1) + (x^3 + x^2 + 1)* (x^4 + 1) + (x^4 + 1)* (x^9 + x^2)

ca = (x^3 + x^2 + 1)* x^6 + (x^3 + x^2 + 1)* x^4 + x^4 + (x^7 + x^3 + 1)* (x^11 + x^10 + 1)
cb = x^6 + (x^3 + x^2 + 1)* x^2 + (x^3 + x^2 + 1)* (x^12 + x^2) + (x^7 + x^3 + 1)* (x^12 + x^7)
cc = x^8 + (x^7 + x^3 + 1)* x^7 + (x^4 + x^3 + x^2 + 1)* x^2 + (x^3 + 1)* (x^3 + x^2 + 1)
cd = (x^7 + x^3 + 1)* x^4 + (x^3 + x)* x^2 + (x^3 + x^2 + 1)* (x^4 + 1) + (x^3 + x^2 + 1)* (x^7 + x^3 + 1)

da = (x^3 + x^2 + 1)* x^7 + (x^11 + x^10 + 1)* x^6 + (x^12 + x^7)* x^2 + (x^3 + x^2 + 1)* (x^11 + x^10 + 1)
db = x^9 + (x^11 + x^10 + 1)* (x^12 + x^2) + 2* (x^3 + x^2 + 1)* (x^12 + x^7)
dc = x^11 + (x^3 + x^2 + 1)* x^7 + (x^3 + 1)* (x^11 + x^10 + 1) + (x^4 + x^3 + x^2 + 1)* (x^12 + x^7)
dd = (x^7 + x^3 + 1)* x^7 + (x^3 + x^2 + 1)^2 + (x^4 + 1)* (x^11 + x^10 + 1) + (x^3 + x)* (x^12 + x^7)

p = Rows [[aa,ab,ac,ad],[ba,bb,bc,bd],[ca,cb,cc,cd],[da,db,dc,dd]]
y = Rows ((map (map field_reduce)) [[x^3,x^2+x^4,1+x^4,1],[x^2+x^9,1+x^2+x^3,x^7,1+x^4],[1+x^2+x^3, x^2, x^4, 1+x^3+x^7],[1+x^10+x^11,x^7+x^12,x^7,1+x^2+x^3]])
z = Rows ((map (map field_reduce)) [[x^6,x^2+x^12,1+x^3,1+x^4],[x^2,1+x^2+x^3,1+x^2+x^3+x^4,x+x^3],[1+x^2+x^3, x^2, x^4, 1+x^3+x^7],[1+x^10+x^11,x^7+x^12,x^7,1+x^2+x^3]])

main = do
  let test = (p == y*z)
  print test
